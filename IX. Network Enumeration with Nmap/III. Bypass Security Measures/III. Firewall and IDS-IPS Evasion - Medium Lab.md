# **Firewall and IDS/IPS Evasion - Medium Lab**

After we conducted the first test and submitted our results to our client, the administrators made some changes and improvements to the `IDS/IPS` and firewall. We could hear that the administrators were not satisfied with their previous configurations during the meeting, and they could see that the network traffic could be filtered more strictly.

## Question

After the configurations are transferred to the system, our client wants to know if it is possible to find out our target's DNS server version. Submit the DNS server version of the target as the answer.

```bash
sudo nmap -sS -sU -p 53 --script dns-nsid --max-retries 0 --min-rate 1000 --max-parallelism 5 -T2 -n <ip>
```

This Nmap command is used to perform a stealthy port scan on the target IP address, focusing on port 53 (DNS). Here's a breakdown of the command and its options:

- `-sS`: This option enables TCP SYN stealth scanning, also known as half-open scanning. It sends SYN packets to the target ports and listens for the response. This method is stealthy because it does not establish a full TCP connection.

- `-sU`: This option enables UDP scanning. UDP scanning involves sending UDP packets to the target ports and waiting for responses. UDP scanning can be more time-consuming and less reliable than TCP scanning because UDP is connectionless and there may not be a response from closed ports.

- `-p 53`: Specifies that Nmap should scan port 53 (DNS) on the target host. Port 53 is commonly associated with DNS services.

- `--script dns-nsid`: This option tells Nmap to use the DNS NSID script during the scan. The DNS NSID script retrieves the Name Server Identifier (NSID) from a DNS server, which can provide information about the server's configuration and identity.

- `--max-retries 0`: Sets the maximum number of retries for failed probes to zero. This means that Nmap will not retry failed probes, reducing the duration of the scan and minimizing the likelihood of detection.

- `--min-rate 1000`: Specifies the minimum rate of packets sent per second. In this case, Nmap will send packets at a rate of 1000 packets per second. This option helps control the speed of the scan to avoid overwhelming the target or triggering intrusion detection systems.

- `--max-parallelism 5`: Limits the number of parallel probes sent by Nmap to 5. This reduces the intensity of the scan and helps avoid detection by spreading out the scan activity over time.

- `-T2`: Sets the timing template to T2 (Paranoid). This timing template slows down the scan to reduce the chance of detection by the target's security mechanisms. It trades off speed for stealth.

- `-n`: This option tells Nmap not to perform DNS resolution. By disabling DNS resolution, Nmap skips the step of resolving hostnames to IP addresses, which can save time and reduce the amount of network traffic generated by the scan.

Overall, this Nmap command is designed to perform a stealthy scan on port 53 of the target host, using both TCP SYN and UDP scanning techniques, while minimizing the risk of detection by intrusion detection systems and firewalls.
